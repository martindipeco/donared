<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <title>DonaRed</title>
  </head>
  <body>
    <p>Publicar una donacion</p>
    <!-- Added enctype="multipart/form-data" to support file uploads -->
    <form action="{% url 'donaredapp:publicar' %}" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <fieldset>  
        <label for="nombre">Nombre:</label>
        <input type="text" id="nombre" name="nombre" required><br><br>
        <label for="descripcion">Descripción:</label>
        <textarea id="descripcion" name="descripcion" required></textarea><br><br>
        <label for="zona">Zona:</label>
        <select id="zona" name="zona" required>
            <option value="" disabled selected>Seleccione...</option>
            {% for zona in zonas %}
                <option value="{{ zona.id }}">{{ zona }}</option>
            {% endfor %}
        </select><br><br>
        <label for="categoria">Categoria:</label>
        <select id="categoria" name="categoria" required>
            <option value="" disabled selected>Seleccione... </option>
            {% for categoria in categorias %}
                <option value="{{ categoria.id }}">{{ categoria }}</option>
            {% endfor %}
        </select><br><br>
        <!-- Add the image upload field -->
        <label for="imagen">Imagen: (máximo 2 mb)</label>
        <input type="file" id="imagen" name="imagen" accept="image/*"><br><br>
    </fieldset>
        <input type="submit" value="Publicar">
    </form>
    <!-- JavaScript para controlar el tamaño máximo de archivo, del lado del cliente -->
    <!-- A reemplzar según consideración equipo Front -->
    <script>
      document.getElementById('imagen').addEventListener('change', function() {
          const file = this.files[0];
          const maxSize = 2 * 1024 * 1024; // 2 MB in bytes
          
          if (file && file.size > maxSize) {
              alert('La imagen no debe exceder {{ MAX_IMAGE_SIZE_MB }}MB');
              this.value = ''; // Clear the input
          }
      });
      </script>
  </body>
</html>