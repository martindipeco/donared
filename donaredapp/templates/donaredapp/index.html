{% extends 'donaredapp/base.html' %}
{% load static %}

{% block title %}DonaRed{% endblock %}

{% block content %}

<!-- Categorías     -->
<section class="categorias">
    <div class="categoria-item">
    <a href="?categoria={{ categorias_dict.ropa }}#seccion-donaciones"><i class="fa-solid fa-shirt 2x"></i>                
    <p>Ropa</p>
    </a>
    </div>
    <div class="categoria-item">
        <a href="?categoria={{ categorias_dict.libros }}#seccion-donaciones">
            <i class="fa-solid fa-book"></i>
            <p>Libros</p>
        </a>
    </div>
    <div class="categoria-item">
        <a href="?categoria={{ categorias_dict.tecnologia }}#seccion-donaciones">
            <i class="fa-solid fa-computer"></i>
            <p>Tecnología</p>
        </a>
    </div>
    <div class="categoria-item">
        <a href="?categoria={{ categorias_dict.herramientas }}#seccion-donaciones">
            <i class="fa-solid fa-screwdriver-wrench"></i>
            <p>Herramientas</p>
        </a>
    </div>
    <div class="categoria-item">
        <a href="?categoria={{ categorias_dict.bicicletas }}#seccion-donaciones">
            <i class="fa-solid fa-bicycle"></i>
            <p>Bicicletas</p>
        </a>
    </div>
    <div class="categoria-item">
        <a href="?categoria={{ categorias_dict.muebles }}#seccion-donaciones">
            <i class="fa-solid fa-couch"></i>
            <p>Muebles</p>
        </a>
    </div>
</section>

<!-- Hero -->
<section class="hero"> 
    <div class="hero-text">
        <h1>Doná lo que ya no usás. <br>Ayudá a quienes más lo necesitan</h1>
        <p>Un objeto olvidado puede ser un gran cambio para otra persona.</p>   
        <div class="hero-buttons">
            {% if user.is_authenticated %}
            <a href="{% url 'donaredapp:publicar' %}" class="btn-donar">Quiero Donar</a>
            {% else %}
            <a href="{% url 'donaredapp:login' %}" class="btn-donar">Iniciá sesión o Registrate para empezar a donar</a>
            {% endif %}
            <a href="#seccion-donaciones" class="btn-donar">Ver donaciones</a>
        </div>      
    </div>
    <div class="hero-image">
        <img src="{% static 'donaredapp/images/foto_tapa.png' %}" alt="imagen-chica">
    </div>
</section>

<!-- ¿Cómo funciona? -->
<section class="como-funciona">
    <div class="como-funciona-contenido">
        <h2>¿Cómo funciona?</h2>
    <div class="pasos">
        <div class="paso">
            <p class="emoji"><i class="fa-solid fa-face-smile"></i></p>
            <h3>Elige qué donar</h3>
            <p>Busca en casa cosas que están en buen estado y pueden ser útiles</p>
        </div>

        <div class="paso">
            <p class="emoji"><i class="fa-solid fa-circle-up"></i></p>
            <h3>Publica tu donación</h3>
            <p>Carga una foto y una breve descripción en minutos</p>
        </div>

        <div class="paso">
            <p class="emoji"><i class="fa-solid fa-hand-holding-heart"></i></p>
            <h3>Alguien lo recibe</h3>
            <p>Una persona que lo necesita se pondrá en contacto para coordinar la entrega</p>
        </div>
    </div>
    
    </div>
</section>

<!-- Inicio Cards donaciones-->
<section id="seccion-donaciones">
    <div class="donaciones" >
        <div class="donaciones-contenido">
            <h2 class="donaciones-titulo">Últimas donaciones</h2>
        </div>
        {% if items_recientes %}
            {% for item in items_recientes %}
            <!-- Card {{ forloop.counter }} -->
            <div class="donar">
                <div class="donar-card">
                    <a href="{% url 'donaredapp:tarjeta' item.id %}">
                    {% if item.imagen %}
                        <img src="{{ item.imagen.url }}" alt="{{ item.nombre }}">
                    {% else %}
                        <img src="{% static 'donaredapp/images/mistery.jpeg' %}" alt="Sin imagen">
                    {% endif %}
                    </a>
                    <h3><a href="{% url 'donaredapp:tarjeta' item.id %}">Donante: {{ item.usuario|default:"Anónimo" }}</a></h3>
                    <h3><a href="{% url 'donaredapp:tarjeta' item.id %}">{{ item.nombre }}</a></h3>
                    <h3><a href="{% url 'donaredapp:tarjeta' item.id %}">{{ item.categoria|default:"Sin categoría" }}</a></h3>
                    <h3><a href="{% url 'donaredapp:tarjeta' item.id %}">Zona: {{ item.zona|default:"Sin especificar" }}</a></h3>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="donar">
                <div class="donar-card">
                    <p>No hay donaciones recientes disponibles.</p>
                </div>
            </div>
        {% endif %}

        <div class="ver-mas-container">
            <!-- Previous button -->
            {% if prev_page %}
                <a href="?{% if current_search.q %}q={{ current_search.q }}
                &{% endif %}{% if current_search.zona %}zona={{ current_search.zona }}
                &{% endif %}{% if current_search.categoria %}categoria={{ current_search.categoria }}
                &{% endif %}page={{ prev_page }}#seccion-donaciones" class="ver-mas-btn">← Anterior</a>
            {% endif %}
            
            <!-- Next button -->
            {% if hay_mas %}
                <a href="?{% if current_search.q %}q={{ current_search.q }}
                &{% endif %}{% if current_search.zona %}zona={{ current_search.zona }}
                &{% endif %}{% if current_search.categoria %}categoria={{ current_search.categoria }}
                &{% endif %}page={{ next_page }}#seccion-donaciones" class="ver-mas-btn">Ver Más →</a>
            {% endif %}
        </div>
        <!-- Buscador -->
        <div class="search-container">
            <form method="GET" action="{% url 'donaredapp:index' %}#seccion-donaciones">
            <input type="text" name="q" placeholder="¿que estás necesitando...?" value="{{ request.GET.q }}">
            
            <select name="zona">
                <option value="" {% if not request.GET.zona %}selected{% endif %}>Todas las zonas</option>
                {% for zona in zonas %}
                <option value="{{ zona.id }}" {% if request.GET.zona == zona.id|stringformat:'i' %}selected{% endif %}>{{ zona.nombre }}</option>
                {% endfor %}
            </select>
            
            <select name="categoria">
                <option value="" {% if not request.GET.categoria %}selected{% endif %}>Todas las categorías</option>
                {% for categoria in categorias %}
                <option value="{{ categoria.id }}" {% if request.GET.categoria == categoria.id|stringformat:'i' %}selected{% endif %}>{{ categoria.nombre }}</option>
                {% endfor %}
            </select>
            
            <button type="submit" class="ver-mas-btn">Buscar</button>
            </form>
        </div>
    </div>
</section>

<!-- Sección de ¿Quiénes somos? -->
<section class="quienes_somos" id="quienes-somos"> 
    <div class="quienes_somos-contenido">
        <img src="{% static 'donaredapp/images/dona3.jpg' %}" class="imagen_planeta" alt="imagen planeta">
        <div class="quienes_somos-texto">
            <h2>Donared</h2>
            <p>DonaRed es una comunidad que une a quienes quieren donar con quienes necesitan recibir. <br>
                Creemos en el poder de compartir, en el cuidado del planeta y en la fuerza de la solidaridad para transformar realidades.<br>
                En DonaRed, cada objeto encuentra una nueva vida, cada conexión suma, y cada gesto cuenta. <br> Todo esto, sin barreras geográficas ni necesidad de dinero.</p>
            <p>Sumate a DonaRed y hacé la diferencia. <br>Juntos, podemos generar un impacto positivo.</p>
        </div>            
    </div>      
    
</section>

{% endblock %}